{"ast":null,"code":"var _jsxFileName = \"E:\\\\PROJECTS\\\\StackOverflowCloneREPO-master\\\\client\\\\src\\\\components\\\\body\\\\question\\\\EditAnswear.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport \"./Question.css\";\n\nfunction EditAnswear(props) {\n  const [answeartext, setansweartext] = useState('');\n  const auth = useSelector(state => state.auth);\n  const token = useSelector(state => state.token);\n  const answearId = props.match.params.answearId;\n  const [photos, setphotos] = useState([]);\n  const [photosinput, setphotosinput] = useState('');\n  const [answearid, setanswearid] = useState('');\n\n  const dropPhoto = i => {\n    let pushArray = [];\n\n    for (let y = 0; y < photos.length; y++) {\n      if (y != i) pushArray.push(photos[y]);\n    }\n\n    setphotos(pushArray);\n  };\n\n  useEffect(() => {\n    axios.post(`/api/answear/get/${answearId}`, {}, {\n      headers: {\n        Authorization: token\n      }\n    }).then(d => {\n      var _d$data;\n\n      if (d.data.redirect) props.history.push(\"/\");else if (d === null || d === void 0 ? void 0 : (_d$data = d.data) === null || _d$data === void 0 ? void 0 : _d$data.answear) {\n        var _d$data2, _d$data2$answear, _d$data2$answear$ques;\n\n        setphotos(d === null || d === void 0 ? void 0 : d.data.answear.images);\n        setansweartext(d === null || d === void 0 ? void 0 : d.data.answear.description);\n        setanswearid(d === null || d === void 0 ? void 0 : (_d$data2 = d.data) === null || _d$data2 === void 0 ? void 0 : (_d$data2$answear = _d$data2.answear) === null || _d$data2$answear === void 0 ? void 0 : (_d$data2$answear$ques = _d$data2$answear.question) === null || _d$data2$answear$ques === void 0 ? void 0 : _d$data2$answear$ques.toString());\n      }\n    });\n  }, [token, answearId, auth]);\n\n  const submitAnswearChanges = async () => {\n    // axios.post()\n    if (answeartext.length > 0) {\n      var _res$data;\n\n      const res = await axios.patch(`/api/answear/${answearId}`, {\n        photos,\n        answeartext\n      }, {\n        headers: {\n          Authorization: token\n        }\n      }); // console.log(res)\n\n      if (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.redirect) {\n        props.history.push(\"/question/\" + answearid);\n      }\n    }\n\n    console.log(answeartext, photos, answearId);\n  };\n\n  const uploadPhoto = async e => {\n    e.preventDefault();\n\n    try {\n      const file = e.target.files[0];\n      if (!file) console.log({\n        err: \"No files were uploaded.\",\n        success: ''\n      });\n      if (file.size > 1024 * 1024) console.log({\n        err: \"Size too large.\",\n        success: ''\n      });\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png' && file.mimetype !== 'image/jpg') console.log({\n        err: \"File format is incorrect.\",\n        success: ''\n      });\n      let formData = new FormData();\n      formData.append('file', file); // setLoading(true)\n\n      const res = await axios.post('/api/answear/uploadimage', formData, {\n        headers: {\n          'content-type': 'multipart/form-data',\n          Authorization: token\n        }\n      }); // setLoading(false)\n\n      console.log(res.data);\n      setphotos([...photos, res.data.url]);\n    } catch (err) {\n      console.log({\n        err: err.response.data.msg,\n        success: ''\n      });\n    }\n  };\n\n  const setphoto = () => {\n    if (photos.indexOf(photosinput) == -1 && photosinput.length) {\n      setphotos([...photos, photosinput]);\n      setphotosinput('');\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inputForm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"textarea\", {\n    className: \"DescriptionInput\",\n    placeholder: \"Body\",\n    value: answeartext,\n    onChange: e => setansweartext(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"imagesMap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }\n  }, photos.map((src, index) => /*#__PURE__*/React.createElement(\"img\", {\n    key: index,\n    src: src,\n    onClick: () => dropPhoto(index),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 37\n    }\n  }))), photos.length < 6 ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, \"Choose PNG/JPG/JPEG\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    name: \"file\",\n    id: \"file_up\",\n    onChange: uploadPhoto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  })) : null, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, photos.length < 6 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"fileInput\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 30\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    placeholder: \"Link on photo\",\n    onChange: e => setphotosinput(e.target.value),\n    value: photosinput,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setphoto(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 11\n    }\n  }, \"Set photo\")) : null), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"create\",\n    onClick: () => submitAnswearChanges(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }\n  }, \"Update question\"));\n}\n\nexport default EditAnswear;","map":{"version":3,"sources":["E:/PROJECTS/StackOverflowCloneREPO-master/client/src/components/body/question/EditAnswear.js"],"names":["React","useState","useEffect","axios","Link","useSelector","useDispatch","EditAnswear","props","answeartext","setansweartext","auth","state","token","answearId","match","params","photos","setphotos","photosinput","setphotosinput","answearid","setanswearid","dropPhoto","i","pushArray","y","length","push","post","headers","Authorization","then","d","data","redirect","history","answear","images","description","question","toString","submitAnswearChanges","res","patch","console","log","uploadPhoto","e","preventDefault","file","target","files","err","success","size","type","mimetype","formData","FormData","append","url","response","msg","setphoto","indexOf","value","map","src","index"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,OAAO,gBAAP;;AAGA,SAASC,WAAT,CAAqBC,KAArB,EAA4B;AAC1B,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCT,QAAQ,CAAC,EAAD,CAA9C;AAEA,QAAMU,IAAI,GAAGN,WAAW,CAACO,KAAK,IAAIA,KAAK,CAACD,IAAhB,CAAxB;AACA,QAAME,KAAK,GAAGR,WAAW,CAACO,KAAK,IAAIA,KAAK,CAACC,KAAhB,CAAzB;AACA,QAAMC,SAAS,GAAGN,KAAK,CAACO,KAAN,CAAYC,MAAZ,CAAmBF,SAArC;AACA,QAAM,CAACG,MAAD,EAASC,SAAT,IAAsBjB,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAACkB,WAAD,EAAcC,cAAd,IAAgCnB,QAAQ,CAAC,EAAD,CAA9C;AACA,QAAM,CAACoB,SAAD,EAAYC,YAAZ,IAA4BrB,QAAQ,CAAC,EAAD,CAA1C;;AAEA,QAAMsB,SAAS,GAAGC,CAAC,IAAI;AACrB,QAAIC,SAAS,GAAG,EAAhB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,MAAM,CAACU,MAA3B,EAAmCD,CAAC,EAApC,EAAwC;AACtC,UAAIA,CAAC,IAAIF,CAAT,EACEC,SAAS,CAACG,IAAV,CAAeX,MAAM,CAACS,CAAD,CAArB;AACH;;AACDR,IAAAA,SAAS,CAACO,SAAD,CAAT;AACD,GAPD;;AASAvB,EAAAA,SAAS,CAAC,MAAM;AACdC,IAAAA,KAAK,CAAC0B,IAAN,CAAY,oBAAmBf,SAAU,EAAzC,EAA4C,EAA5C,EAAgD;AAC9CgB,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAElB;AAAjB;AADqC,KAAhD,EAEGmB,IAFH,CAEQC,CAAC,IAAI;AAAA;;AACX,UAAIA,CAAC,CAACC,IAAF,CAAOC,QAAX,EACE3B,KAAK,CAAC4B,OAAN,CAAcR,IAAd,CAAmB,GAAnB,EADF,KAEK,IAAIK,CAAJ,aAAIA,CAAJ,kCAAIA,CAAC,CAAEC,IAAP,4CAAI,QAASG,OAAb,EAAsB;AAAA;;AACzBnB,QAAAA,SAAS,CAACe,CAAD,aAACA,CAAD,uBAACA,CAAC,CAAEC,IAAH,CAAQG,OAAR,CAAgBC,MAAjB,CAAT;AACA5B,QAAAA,cAAc,CAACuB,CAAD,aAACA,CAAD,uBAACA,CAAC,CAAEC,IAAH,CAAQG,OAAR,CAAgBE,WAAjB,CAAd;AACAjB,QAAAA,YAAY,CAACW,CAAD,aAACA,CAAD,mCAACA,CAAC,CAAEC,IAAJ,iEAAC,SAASG,OAAV,8EAAC,iBAAkBG,QAAnB,0DAAC,sBAA4BC,QAA5B,EAAD,CAAZ;AACD;AACF,KAVD;AAYD,GAbQ,EAaN,CAAC5B,KAAD,EAAQC,SAAR,EAAmBH,IAAnB,CAbM,CAAT;;AAcA,QAAM+B,oBAAoB,GAAG,YAAY;AACvC;AACA,QAAIjC,WAAW,CAACkB,MAAZ,GAAqB,CAAzB,EAA4B;AAAA;;AAC1B,YAAMgB,GAAG,GAAG,MAAMxC,KAAK,CAACyC,KAAN,CAAa,gBAAe9B,SAAU,EAAtC,EAAyC;AAAEG,QAAAA,MAAF;AAAUR,QAAAA;AAAV,OAAzC,EAAkE;AAClFqB,QAAAA,OAAO,EAAE;AAAEC,UAAAA,aAAa,EAAElB;AAAjB;AADyE,OAAlE,CAAlB,CAD0B,CAI1B;;AACA,UAAI8B,GAAJ,aAAIA,GAAJ,oCAAIA,GAAG,CAAET,IAAT,8CAAI,UAAWC,QAAf,EAAyB;AACvB3B,QAAAA,KAAK,CAAC4B,OAAN,CAAcR,IAAd,CAAmB,eAAeP,SAAlC;AACD;AAEF;;AACDwB,IAAAA,OAAO,CAACC,GAAR,CAAYrC,WAAZ,EAAyBQ,MAAzB,EAAiCH,SAAjC;AACD,GAbD;;AAcA,QAAMiC,WAAW,GAAG,MAAOC,CAAP,IAAa;AAC/BA,IAAAA,CAAC,CAACC,cAAF;;AACA,QAAI;AACF,YAAMC,IAAI,GAAGF,CAAC,CAACG,MAAF,CAASC,KAAT,CAAe,CAAf,CAAb;AAEA,UAAI,CAACF,IAAL,EAAWL,OAAO,CAACC,GAAR,CAAY;AAAEO,QAAAA,GAAG,EAAE,yBAAP;AAAkCC,QAAAA,OAAO,EAAE;AAA3C,OAAZ;AAEX,UAAIJ,IAAI,CAACK,IAAL,GAAY,OAAO,IAAvB,EACEV,OAAO,CAACC,GAAR,CAAY;AAAEO,QAAAA,GAAG,EAAE,iBAAP;AAA0BC,QAAAA,OAAO,EAAE;AAAnC,OAAZ;AAEF,UAAIJ,IAAI,CAACM,IAAL,KAAc,YAAd,IAA8BN,IAAI,CAACM,IAAL,KAAc,WAA5C,IAA2DN,IAAI,CAACO,QAAL,KAAkB,WAAjF,EACEZ,OAAO,CAACC,GAAR,CAAY;AAAEO,QAAAA,GAAG,EAAE,2BAAP;AAAoCC,QAAAA,OAAO,EAAE;AAA7C,OAAZ;AAEF,UAAII,QAAQ,GAAG,IAAIC,QAAJ,EAAf;AACAD,MAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBV,IAAxB,EAZE,CAcF;;AACA,YAAMP,GAAG,GAAG,MAAMxC,KAAK,CAAC0B,IAAN,CAAW,0BAAX,EAAuC6B,QAAvC,EAAiD;AACjE5B,QAAAA,OAAO,EAAE;AAAE,0BAAgB,qBAAlB;AAAyCC,UAAAA,aAAa,EAAElB;AAAxD;AADwD,OAAjD,CAAlB,CAfE,CAmBF;;AACAgC,MAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACT,IAAhB;AACAhB,MAAAA,SAAS,CAAC,CAAC,GAAGD,MAAJ,EAAY0B,GAAG,CAACT,IAAJ,CAAS2B,GAArB,CAAD,CAAT;AAED,KAvBD,CAuBE,OAAOR,GAAP,EAAY;AACZR,MAAAA,OAAO,CAACC,GAAR,CAAY;AAAEO,QAAAA,GAAG,EAAEA,GAAG,CAACS,QAAJ,CAAa5B,IAAb,CAAkB6B,GAAzB;AAA8BT,QAAAA,OAAO,EAAE;AAAvC,OAAZ;AACD;AACF,GA5BD;;AA6BA,QAAMU,QAAQ,GAAG,MAAM;AACrB,QAAI/C,MAAM,CAACgD,OAAP,CAAe9C,WAAf,KAA+B,CAAC,CAAhC,IAAqCA,WAAW,CAACQ,MAArD,EAA6D;AAC3DT,MAAAA,SAAS,CAAC,CAAC,GAAGD,MAAJ,EAAYE,WAAZ,CAAD,CAAT;AACAC,MAAAA,cAAc,CAAC,EAAD,CAAd;AACD;AACF,GALD;;AAQA,sBAGE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAU,IAAA,SAAS,EAAC,kBAApB;AAAuC,IAAA,WAAW,EAAC,MAAnD;AAA0D,IAAA,KAAK,EAAEX,WAAjE;AAA8E,IAAA,QAAQ,EAAEuC,CAAC,IAAItC,cAAc,CAACsC,CAAC,CAACG,MAAF,CAASe,KAAV,CAA3G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAIE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGjD,MAAM,CAACkD,GAAP,CAAW,CAACC,GAAD,EAAMC,KAAN,kBAAgB;AAAK,IAAA,GAAG,EAAEA,KAAV;AAAiB,IAAA,GAAG,EAAED,GAAtB;AAA2B,IAAA,OAAO,EAAE,MAAM7C,SAAS,CAAC8C,KAAD,CAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAA3B,CADH,CAJF,EAOGpD,MAAM,CAACU,MAAP,GAAgB,CAAhB,gBAAoB,uDACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BADmB,eAEnB;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,IAAI,EAAC,MAAxB;AAA+B,IAAA,EAAE,EAAC,SAAlC;AAA4C,IAAA,QAAQ,EAAEoB,WAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFmB,CAApB,GAE4E,IAT/E,eAUE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG9B,MAAM,CAACU,MAAP,GAAgB,CAAhB,gBAAoB;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACnB;AAAO,IAAA,WAAW,EAAC,eAAnB;AAAmC,IAAA,QAAQ,EAAEqB,CAAC,IAAI5B,cAAc,CAAC4B,CAAC,CAACG,MAAF,CAASe,KAAV,CAAhE;AAAkF,IAAA,KAAK,EAAE/C,WAAzF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADmB,eAEnB;AAAQ,IAAA,OAAO,EAAE,MAAM6C,QAAQ,EAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAFmB,CAApB,GAE+D,IAHlE,CAVF,eAeE;AAAQ,IAAA,SAAS,EAAC,QAAlB;AAA2B,IAAA,OAAO,EAAE,MAAMtB,oBAAoB,EAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAfF,CAHF;AAuBD;;AAED,eAAenC,WAAf","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport axios from 'axios'\nimport { Link } from 'react-router-dom'\nimport { useSelector, useDispatch } from 'react-redux'\nimport \"./Question.css\"\n\n\nfunction EditAnswear(props) {\n  const [answeartext, setansweartext] = useState('')\n\n  const auth = useSelector(state => state.auth)\n  const token = useSelector(state => state.token)\n  const answearId = props.match.params.answearId;\n  const [photos, setphotos] = useState([])\n  const [photosinput, setphotosinput] = useState('')\n  const [answearid, setanswearid] = useState('')\n\n  const dropPhoto = i => {\n    let pushArray = []\n    for (let y = 0; y < photos.length; y++) {\n      if (y != i)\n        pushArray.push(photos[y])\n    }\n    setphotos(pushArray)\n  }\n\n  useEffect(() => {\n    axios.post(`/api/answear/get/${answearId}`, {}, {\n      headers: { Authorization: token }\n    }).then(d => {\n      if (d.data.redirect)\n        props.history.push(\"/\");\n      else if (d?.data?.answear) {\n        setphotos(d?.data.answear.images)\n        setansweartext(d?.data.answear.description)\n        setanswearid(d?.data?.answear?.question?.toString())\n      }\n    })\n\n  }, [token, answearId, auth])\n  const submitAnswearChanges = async () => {\n    // axios.post()\n    if (answeartext.length > 0) {\n      const res = await axios.patch(`/api/answear/${answearId}`, { photos, answeartext }, {\n        headers: { Authorization: token }\n      })\n      // console.log(res)\n      if (res?.data?.redirect) {\n        props.history.push(\"/question/\" + answearid)\n      }\n\n    }\n    console.log(answeartext, photos, answearId)\n  }\n  const uploadPhoto = async (e) => {\n    e.preventDefault()\n    try {\n      const file = e.target.files[0]\n\n      if (!file) console.log({ err: \"No files were uploaded.\", success: '' })\n\n      if (file.size > 1024 * 1024)\n        console.log({ err: \"Size too large.\", success: '' })\n\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png' && file.mimetype !== 'image/jpg')\n        console.log({ err: \"File format is incorrect.\", success: '' })\n\n      let formData = new FormData()\n      formData.append('file', file)\n\n      // setLoading(true)\n      const res = await axios.post('/api/answear/uploadimage', formData, {\n        headers: { 'content-type': 'multipart/form-data', Authorization: token }\n      })\n\n      // setLoading(false)\n      console.log(res.data)\n      setphotos([...photos, res.data.url])\n\n    } catch (err) {\n      console.log({ err: err.response.data.msg, success: '' })\n    }\n  }\n  const setphoto = () => {\n    if (photos.indexOf(photosinput) == -1 && photosinput.length) {\n      setphotos([...photos, photosinput])\n      setphotosinput('')\n    }\n  }\n\n\n  return (\n\n\n    <div className=\"inputForm\">\n      <textarea className=\"DescriptionInput\" placeholder=\"Body\" value={answeartext} onChange={e => setansweartext(e.target.value)}></textarea>\n\n\n      <div className=\"imagesMap\">\n        {photos.map((src, index) => <img key={index} src={src} onClick={() => dropPhoto(index)} />)}\n      </div>\n      {photos.length < 6 ? <>\n        <label>Choose PNG/JPG/JPEG</label>\n        <input type=\"file\" name=\"file\" id=\"file_up\" onChange={uploadPhoto} /></> : null}\n      <div>\n        {photos.length < 6 ? <div className=\"fileInput\">\n          <input placeholder=\"Link on photo\" onChange={e => setphotosinput(e.target.value)} value={photosinput} />\n          <button onClick={() => setphoto()}>Set photo</button></div> : null}\n      </div>\n      <button className=\"create\" onClick={() => submitAnswearChanges()}>Update question</button>\n\n    </div>\n\n  )\n}\n\nexport default EditAnswear"]},"metadata":{},"sourceType":"module"}